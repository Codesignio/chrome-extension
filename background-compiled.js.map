{"version":3,"sources":["webpack:///webpack/bootstrap 6273cacf6e8e27bdc75a","webpack:///./background.js","webpack:///./app/utils.js"],"names":[],"mappings":"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","file":"background-compiled.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 6273cacf6e8e27bdc75a\n **/","var canvas;\nvar screenshot;\nvar sendedrequest;\nvar capturedImage;\nvar token = localStorage.token;\n\nimport {request} from './app/utils';\nimport {s3Upload} from './app/utils';\nimport {dataURItoBlob} from './app/utils';\n\nchrome.contextMenus.create({\n  \"title\": \"Add Comment\",\n  \"contexts\": [\"page\"],\n  \"onclick\" : clickHandler\n});\n\n function clickHandler(e) {\n   chrome.tabs.getSelected(null, function (tab) {\n         chrome.tabs.executeScript(tab.id, {file: 'page-script-compiled/comment.js'}, function () {\n           chrome.tabs.sendRequest(tab.id, {msg: 'contextMenu'}, function () {\n           });\n         });\n   });\n }\n\n\n\nchrome.extension.onRequest.addListener(function (request, sender, callback) {\n  if (request.msg === 'capturePart'){\n    cropVisible(request, sender, callback);\n  } else if (request.msg === 'capturePage') {\n    capturePage(request, sender, callback);\n  } else if (request.msg === 'takeFullPageScreenshoot'){\n    chrome.tabs.getSelected(null, function (tab) {\n      chrome.tabs.executeScript(tab.id, {file: 'page.js'}, function () {\n        sendScrollMessage(tab);\n      });\n    });\n  } else if (request.msg == 'addPin'){\n    sendedrequest = request;\n    localStorage.currentAction = 'comment';\n    chrome.browserAction.setBadgeText({text: request.pins.length.toString() });\n  }\n});\n\nchrome.runtime.onMessage.addListener(\n  function(request, sender, sendResponse) {\n    if (request.msg === 'takeFullPageScreenshoot'){\n      chrome.tabs.getSelected(null, function (tab) {\n        chrome.tabs.executeScript(tab.id, {file: 'page.js'}, function () {\n          sendScrollMessage(tab);\n        });\n      });\n    } else if (request.msg === 'token'){\n      token = request.token\n    } else if (request.msg == 'uploadImages'){\n      if(sendedrequest){\n        uploadImageAndPins();\n      } else {\n        uploadImages(request, sender, sendResponse)\n      }\n    } else if (request.msg == 'uploadImageAndPins'){\n      uploadImageAndPins();\n    }\n  });\n\n\nfunction uploadImages(req, sender, sendResponse){\n  var token = localStorage.token;\n  var activeBoard = req.activeBoard;\n  var activeFolder = req.activeFolder;\n  var posts = [];\n\n  function logCallBack(value){\n    chrome.runtime.sendMessage({msg: 'progress', progress: value})\n  }\n\n\n  if(activeBoard.id == 'new_board'){\n    request('http://api.codesign.io/folders/'+ activeFolder + '/boards/', 'POST', {\"Authorization\": 'Token ' + token, \"Content-Type\": \"application/json;charset=UTF-8\" }, {\n      title: \"New Board\"\n    }, function (data) {\n      activeBoard = data.id;\n      uploadImageProcess2(activeBoard,posts, logCallBack);\n    });\n\n  } else {\n\n    request('http://api.codesign.io/boards/' + activeBoard + '/posts/', 'GET', {\"Authorization\": 'Token ' + token}, null, function (data) {\n      posts = data.results;\n      uploadImageProcess2(activeBoard,posts, logCallBack);\n    });\n  }\n}\n\nfunction uploadImageProcess2(activeBoard,posts, logCallBack){\n\n    var token = localStorage.token;\n    var me = this;\n    var capturedImage = JSON.parse(localStorage.capturedImage);\n\n    request('http://api.codesign.io/boards/'+ activeBoard + '/posts/', 'POST', {\"Authorization\": 'Token ' + token, \"Content-Type\": \"application/json;charset=UTF-8\" }, {\n      title: capturedImage.url + \" \" + (new Date).toString()\n    }, function (data) {\n      console.log(data);\n      request('http://api.codesign.io/posts/'+ data.id + '/images/get_upload_url/?filename='+ capturedImage.name +'&image_type=image%2Fjpeg&thumbnail_type=image%2Fjpeg', 'GET', {\"Authorization\": 'Token ' + token}, null, function (data1) {\n        console.log(data1);\n\n        window.webkitResolveLocalFileSystemURL(capturedImage.link, function(fileEntry){\n          console.log('fillllle');\n          fileEntry.file(function(file) {\n            s3Upload(data1.image_upload_url, file, logCallBack, function (data2) {\n\n              var canvas = document.createElement('canvas');\n              canvas.width = 250;\n              canvas.height = 150;\n              var image = new Image();\n              image.onload = function () {\n                canvas.getContext('2d').drawImage(image, 0,0, this.width, this.height, 0,0, 250,150);\n\n                var blob =  dataURItoBlob(canvas.toDataURL());\n                s3Upload(data1.thumbnail_upload_url, blob, logCallBack, function () {\n\n                  request('http://api.codesign.io/posts/'+ data.id +'/images/', 'POST', {\"Authorization\": 'Token ' + token, \"Content-Type\": \"application/json;charset=UTF-8\"}, {\n                    image_upload_url:data1.image_upload_url,\n                    thumbnail_upload_url: data1.thumbnail_upload_url,\n                    width: capturedImage.size.width,\n                    height: capturedImage.size.height\n                  }, function (data3) {\n\n                    request('http://api.codesign.io/boards/'+ activeBoard + '/update_order/', 'POST', {\"Authorization\": 'Token ' + token, \"Content-Type\": \"application/json;charset=UTF-8\"}, {\n                      keys: posts.map((post)=> post.id).concat(data.id)\n                    }, function () {\n                      chrome.runtime.sendMessage({msg: 'upload_done'})\n                    });\n\n                  });\n\n                });\n\n              };\n              image.src = capturedImage.link;\n\n            });\n          });\n        });\n\n\n      });\n\n    });\n}\n\n\n\n\nfunction cropVisible(data, sender, callback) {\n  canvas = document.createElement('canvas');\n  canvas.width = data.width;\n  canvas.height = data.height;\n\n  chrome.tabs.captureVisibleTab(\n    null, {format: 'png', quality: 100}, function (dataURI) {\n      if (dataURI) {\n        var image = new Image();\n        image.onload = function () {\n          canvas.getContext('2d').drawImage(image, data.left+1, data.top+1, data.width, data.height, 0, 0, data.width, data.height);\n          openPage(data);\n          callback(true);\n        };\n        image.src = dataURI;\n      }\n    });\n}\n\n\nfunction openPage(data) {\n  var capturedImageSize;\n  var dataURI;\n  if (screenshot){\n    dataURI = screenshot.canvas.toDataURL();\n    capturedImageSize = {width: screenshot.canvas.width, height: screenshot.canvas.height};\n  } else {\n    dataURI = canvas.toDataURL();\n  }\n\n  var byteString = atob(dataURI.split(',')[1]);\n  var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n  var ab = new ArrayBuffer(byteString.length);\n  var ia = new Uint8Array(ab);\n  for (var i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n  var blob = new Blob([ab], {type: mimeString});\n  var size = blob.size + (1024 / 2);\n  var name = data.url.split('?')[0].split('#')[0];\n  if (name) {\n    name = name\n      .replace(/^https?:\\/\\//, '')\n      .replace(/[^A-z0-9]+/g, '-')\n      .replace(/-+/g, '-')\n      .replace(/^[_\\-]+/, '')\n      .replace(/[_\\-]+$/, '');\n    name = '-' + name;\n  } else {\n    name = '';\n  }\n  name = 'screencapture' + name + '-' + Date.now() + '.png';\n\n  function onwriteend() {\n    var url = 'filesystem:chrome-extension://' + chrome.i18n.getMessage('@@extension_id') + '/temporary/' + name;\n    capturedImage = {link: url, size: capturedImageSize || {width: data.width, height: data.height}, url: data.url.split('?')[0]};\n\n      localStorage.capturedImage = JSON.stringify(capturedImage);\n      var images = JSON.parse(localStorage.images || '[]');\n      images.push(capturedImage);\n      localStorage.images = JSON.stringify(images);\n      chrome.runtime.sendMessage({msg: 'captured', capturedImage: capturedImage});\n      chrome.browserAction.setBadgeText({text: capturedImageSize ? '': 'done'});\n\n\n    //canvas = null;\n    //screenshot = null;\n  }\n\n  window.webkitRequestFileSystem(window.TEMPORARY, size, function (fs) {\n    fs.root.getFile(name, {create: true}, function (fileEntry) {\n      fileEntry.createWriter(function (fileWriter) {\n        fileWriter.onwriteend = onwriteend\n        fileWriter.write(blob);\n      });\n    });\n  });\n}\n\nfunction sendScrollMessage(tab) {\n  screenshot = {};\n  chrome.tabs.sendRequest(tab.id, {msg: 'scrollPage'}, function () {\n    openPage({url: tab.url});\n  });\n}\n\n\nfunction capturePage(data, sender, callback) {\n  var progressStatus = parseInt(data.complete * 100, 10) + '%';\n  chrome.runtime.sendMessage({msg: 'progress', progress: progressStatus});\n  chrome.browserAction.setBadgeText({text: progressStatus});\n\n  var scale = data.devicePixelRatio && data.devicePixelRatio !== 1 ?\n  1 / data.devicePixelRatio : 1;\n  if (scale !== 1) {\n    data.x = data.x / scale;\n    data.y = data.y / scale;\n    data.totalWidth = data.totalWidth / scale;\n    data.totalHeight = data.totalHeight / scale;\n  }\n  if (!screenshot.canvas) {\n    canvas = document.createElement('canvas');\n    canvas.width = data.totalWidth;\n    canvas.height = data.totalHeight;\n    screenshot.canvas = canvas;\n    screenshot.ctx = canvas.getContext('2d');\n  }\n\n  chrome.tabs.captureVisibleTab(\n    null, {format: 'png', quality: 100}, function (dataURI) {\n      if (dataURI) {\n        var image = new Image();\n        image.onload = function () {\n          screenshot.ctx.drawImage(image, data.x, data.y);\n          callback(true);\n        };\n        image.src = dataURI;\n      }\n    });\n}\n\n\nfunction uploadImageAndPins(){;\n\n  var folders;\n  request('http://api.codesign.io/folders/', 'GET', {\"Authorization\": 'Token ' + token}, null, function (data1) {\n    folders = data1.results;\n\n    request('http://api.codesign.io/folders/'+ folders[0].id + '/boards/', 'POST', {\"Authorization\": 'Token ' + token, \"Content-Type\": \"application/json;charset=UTF-8\" }, {\n      title: sendedrequest.pageTitle\n    }, function (data) {\n      uploadImageProcess(data.id, data.client_code);\n    });\n  })\n\n\n}\n\nfunction logProgress(percent){\n  chrome.browserAction.setBadgeText({text: percent+'%'});\n}\n\nfunction uploadImageProcess(activeBoard, boardCode)\n{\n  var link = capturedImage.link;\n\n  request('http://api.codesign.io/boards/' + activeBoard + '/posts/', 'POST', {\n    \"Authorization\": 'Token ' + token,\n    \"Content-Type\": \"application/json;charset=UTF-8\"\n  }, {\n    title: capturedImage.url + \" \" + (new Date).toString()\n  }, function (data) {\n    console.log(data);\n    request('http://api.codesign.io/posts/' + data.id + '/images/get_upload_url/?filename=' + capturedImage.name + '&image_type=image%2Fjpeg&thumbnail_type=image%2Fjpeg', 'GET', {\"Authorization\": 'Token ' + token}, null, function (data1) {\n      console.log(data1);\n\n      window.webkitResolveLocalFileSystemURL(link, function (fileEntry) {\n        fileEntry.file(function (file) {\n          s3Upload(data1.image_upload_url, file, logProgress, function (data2) {\n\n            var canvas = document.createElement('canvas');\n            canvas.width = 250;\n            canvas.height = 150;\n            var image = new Image();\n            image.onload = function () {\n              canvas.getContext('2d').drawImage(image, 0, 0, this.width, this.height, 0, 0, 250, 150);\n\n              var blob = dataURItoBlob(canvas.toDataURL());\n              s3Upload(data1.thumbnail_upload_url, blob, logProgress, function () {\n\n                request('http://api.codesign.io/posts/' + data.id + '/images/', 'POST', {\n                  \"Authorization\": 'Token ' + token,\n                  \"Content-Type\": \"application/json;charset=UTF-8\"\n                }, {\n                  image_upload_url: data1.image_upload_url,\n                  thumbnail_upload_url: data1.thumbnail_upload_url,\n                  width: capturedImage.size.width,\n                  height: capturedImage.size.height\n                }, function (data3) {\n\n                  var reqCount = 0;\n\n                  for (var i = 0; i < sendedrequest.pins.length;i++) {\n                    var pin = sendedrequest.pins[i];\n                    request('http://api.codesign.io/posts/' + data.id + '/tasks/', 'POST', {\n                      \"Authorization\": 'Token ' + token,\n                      \"Content-Type\": \"application/json;charset=UTF-8\"\n                    }, {\n                      marker: {\n                        geometry: {\n                          left: pin.x/capturedImage.size.width * 100,\n                          top: pin.y/capturedImage.size.height * 100\n                        },\n                        measure: 'pixel',\n                        shape: \"PN\"\n                      },\n                      title: pin.text\n                    }, function (data3) {\n                      reqCount++;\n                      if (reqCount == sendedrequest.pins.length){\n                        chrome.tabs.create({url: 'http://www.codesign.io/board/' + boardCode});\n                        chrome.browserAction.setBadgeText({text: ''});\n                        capturedImage = null;\n                        sendedrequest = null;\n                      }\n\n                    });\n                  }\n\n                });\n\n              });\n\n            };\n            image.src = link;\n\n          });\n        });\n      });\n\n\n    });\n\n  });\n}\n\n\n/** WEBPACK FOOTER **\n ** ./background.js\n **/","export function request(url, method, headers, body, callback){\n  var xhr = new XMLHttpRequest();\n  var json = JSON.stringify(body);\n  xhr.open(method, url, true);\n  for (var i in headers){\n    xhr.setRequestHeader(i, headers[i]);\n  };\n  xhr.onreadystatechange = function() {\n    if (xhr.readyState != 4) return;\n    callback(JSON.parse(xhr.responseText));\n  };\n  xhr.send(json);\n}\n\nexport function s3Upload(url, imageFile, logCallback, callBack){\n\n  var xhr = new XMLHttpRequest();\n  xhr.onerror = e => {\n    console.log('error')\n  };\n\n  xhr.upload.addEventListener('progress', e => {\n    var percent = Math.round((e.loaded / e.total) * 100);\n    logCallback(percent);\n  }, false);\n\n  xhr.onreadystatechange = () => {\n    if (xhr.readyState === XMLHttpRequest.DONE) {\n      if (xhr.status >= 200 && xhr.status <= 299) {\n        callBack(xhr.responseText)\n      } else {\n        console.log('error')\n      }\n    }\n  };\n\n  xhr.open('PUT', url, true);\n  xhr.setRequestHeader('Content-Type', 'image/jpeg');\n  xhr.setRequestHeader('Cache-Control', 'public, max-age=31536000');\n  xhr.send(imageFile);\n}\n\nexport function dataURItoBlob(dataURL) {\n  var BASE64_MARKER = ';base64,';\n  if (dataURL.indexOf(BASE64_MARKER) == -1) {\n    var parts = dataURL.split(',');\n    var contentType = parts[0].split(':')[1];\n    var raw = decodeURIComponent(parts[1]);\n\n    return new Blob([raw], {type: contentType});\n  }\n\n  var parts = dataURL.split(BASE64_MARKER);\n  var contentType = parts[0].split(':')[1];\n  var raw = window.atob(parts[1]);\n  var rawLength = raw.length;\n\n  var uInt8Array = new Uint8Array(rawLength);\n\n  for (var i = 0; i < rawLength; ++i) {\n    uInt8Array[i] = raw.charCodeAt(i);\n  }\n\n  return new Blob([uInt8Array], {type: contentType});\n}\n\n\n/** WEBPACK FOOTER **\n ** ./app/utils.js\n **/"],"sourceRoot":""}