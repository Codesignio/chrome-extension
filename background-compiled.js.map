{"version":3,"sources":["webpack:///webpack/bootstrap e9fcfe65c224cd64a8cc","webpack:///./background.js","webpack:///./app/utils.js"],"names":[],"mappings":"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","file":"background-compiled.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e9fcfe65c224cd64a8cc\n **/","var screenshot = {};\nvar sendedrequest = {};\nvar cropData = null;\nvar startOauth;\n\nimport {request as httprequest} from './app/utils';\nimport {s3Upload} from './app/utils';\nimport {dataURItoBlob} from './app/utils';\n\nchrome.contextMenus.create({\n  \"title\": \"Add Comment\",\n  \"contexts\": [\"all\"],\n  \"onclick\" : clickHandler\n});\n\n function clickHandler(e) {\n   chrome.tabs.getSelected(null, function (tab) {\n     chrome.tabs.executeScript(tab.id, {code: 'window.codesign = {me: '+ localStorage.me+'}'}, function () {\n       chrome.tabs.executeScript(tab.id, {file: 'page-script-compiled/comment.js'}, function () {\n         chrome.tabs.sendRequest(tab.id, {msg: 'contextMenu'}, function () {\n         });\n       });\n     });\n\n   });\n }\n\n\n\nchrome.runtime.onInstalled.addListener(function(){\n  chrome.tabs.create({'url': 'http://www.codesign.io/checkauthorization'}, function (tab) {});\n});\n\n\nchrome.extension.onRequest.addListener(function (request, sender, callback) {\n  if (request.msg === 'capturePage') {\n    capturePage(request, sender, callback);\n  } else if (request.msg === 'cropData'){\n    cropData = request;\n    localStorage.currentAction = 'crop';\n    chrome.browserAction.setBadgeText({text: 'share'});\n  } else if (request.msg == 'addPin' || request.msg == 'deletePin' || request.msg == 'completePin' || request.msg == 'addComment' || request.msg == 'deleteComment'){\n\n\n    if (!request.commentMode){\n      sendedrequest = request;\n      if(request.pins.length){\n        localStorage.currentAction = 'comment';\n      }\n    } else {\n      sendRequestPin(request,sender, callback)\n    }\n\n    chrome.browserAction.setBadgeText({text: request.pins.length ? 'share' : '' });\n\n  } else if (request.msg == 'cancelCrop'){\n    cropData = null;\n    localStorage.currentAction = '';\n    chrome.browserAction.setBadgeText({text: ''});\n  }  else if (request.msg == 'checkStartOauth'){\n    callback(startOauth);\n  } else if (request.msg == 'stopOauth'){\n    console.log('stopOauth');\n    if (request.token){\n      localStorage.token = request.token;\n      chrome.tabs.getSelected(null, function (tab) {\n        chrome.tabs.remove(tab.id);\n        chrome.tabs.create({'url': chrome.extension.getURL('login-sucessfully.html')}, function (tab) {\n          var token = localStorage.token;\n          httprequest('http://api.codesign.io/users/me/', 'GET', {\"Authorization\": 'Token ' +  token}, null, function (data) {\n            localStorage.me = JSON.stringify(data);\n          });\n        });\n        if (!request.fromSite) chrome.tabs.create({'url': 'http://www.codesign.io/syncauthorization', selected: false}, function (tab) {});\n      })\n    } else {\n      chrome.tabs.getSelected(null, function (tab) {\n        chrome.tabs.update(tab.id, {url: chrome.extension.getURL('login.html')})\n      })\n    }\n    startOauth = null;\n  } else if (request.msg == 'syncAuthorization'){\n    if (!request.token){\n      callback(localStorage.token)\n    } else {\n      chrome.tabs.remove(sender.tab.id);\n    }\n  } else if (request.msg == 'closeWindow'){\n    console.log('closeWindow');\n    chrome.tabs.remove(sender.tab.id);\n  } else if (request.msg == 'liveBoard'){\n    loadBoardData(request, sender, callback)\n  }\n});\n\nchrome.runtime.onMessage.addListener(\n  function(request, sender, sendResponse) {\n    if (request.msg === 'takeFullPageScreenshot'){\n      takeFullPageScreenshot();\n    } else if(request.msg === 'takeVisiblePageScreenshot'){\n      takeVisibleScreenshot();\n    } else if (request.msg == 'uploadImages'){\n      uploadImages(request, sender, sendResponse)\n    } else if (request.msg == 'startOauth'){\n      startOauth = true;\n    } else if (request.msg == 'shareImage'){\n      shareImage(request, sender, sendResponse)\n    }\n  });\n\n\nfunction takeFullPageScreenshot(){\n  chrome.tabs.getSelected(null, function (tab) {\n    chrome.tabs.sendRequest(tab.id, {msg: 'removeOverlay'}, function () {\n      chrome.tabs.executeScript(tab.id, {file: 'page.js'}, function () {\n        chrome.tabs.sendRequest(tab.id, {msg: 'scrollPage'}, function () {\n          screenshotCaptured(screenshot, tab.url, tab.title)\n        });\n      });\n    });\n  });\n}\n\n\n\nfunction takeVisibleScreenshot(){\n  captureVisible(function(canvas){\n    chrome.tabs.getSelected(null, function (tab) {\n      screenshotCaptured({canvas: canvas}, tab.url, tab.title)\n    })\n  })\n}\n\n\nfunction capturePage(data, sender, callback) {\n  var progressStatus = parseInt(data.complete * 100, 10) + '%';\n  chrome.runtime.sendMessage({msg: 'progress', progress: progressStatus, progressMsg: 'Capturing...'});\n  chrome.browserAction.setBadgeText({text: progressStatus});\n\n  var scale = data.devicePixelRatio && data.devicePixelRatio !== 1 ?\n  1 / data.devicePixelRatio : 1;\n  if (scale !== 1) {\n    data.x = data.x / scale;\n    data.y = data.y / scale;\n    data.totalWidth = data.totalWidth / scale;\n    data.totalHeight = data.totalHeight / scale;\n  }\n  if (!screenshot.canvas) {\n    screenshot.canvas = document.createElement('canvas');\n    screenshot.canvas.width = data.totalWidth;\n    screenshot.canvas.height = data.totalHeight;\n  }\n\n  captureVisible(function(){\n    callback(true);\n  }, {left: data.x, top: data.y})\n}\n\n\n\n\nfunction captureVisible(callBack, canvasPos){\n  chrome.tabs.captureVisibleTab(null, {format: 'png', quality: 100}, function (dataURI) {\n\n    if (dataURI) {\n      var image = new Image();\n      image.onload = function () {\n\n\n        if(screenshot.canvas) {\n          screenshot.canvas.getContext('2d').drawImage(image, canvasPos.left, canvasPos.top);\n          callBack();\n        } else {\n          var capturedImageSize = {width: this.width, height: this.height, left: 0, top: 0};\n          if(cropData) capturedImageSize = cropData;\n\n          var canvas = document.createElement('canvas');\n          canvas.width = capturedImageSize.width;\n          canvas.height = capturedImageSize.height;\n          canvas.getContext('2d').drawImage(image, capturedImageSize.left, capturedImageSize.top, capturedImageSize.width, capturedImageSize.height, 0, 0, capturedImageSize.width, capturedImageSize.height);\n\n          callBack(canvas);\n          console.log(canvas);\n        }\n      };\n      image.src = dataURI;\n    }\n  })\n}\n\nfunction storeFromDataCanvas(canvas, pageUrl, callBack){\n  var dataURI = canvas.toDataURL();\n  var byteString = atob(dataURI.split(',')[1]);\n  var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n  var ab = new ArrayBuffer(byteString.length);\n  var ia = new Uint8Array(ab);\n  for (var i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n  var blob = new Blob([ab], {type: mimeString});\n  var size = blob.size + (1024 / 2);\n\n\n  var name = pageUrl.split('?')[0].split('#')[0];\n  if (name) {\n    name = name\n      .replace(/^https?:\\/\\//, '')\n      .replace(/[^A-z0-9]+/g, '-')\n      .replace(/-+/g, '-')\n      .replace(/^[_\\-]+/, '')\n      .replace(/[_\\-]+$/, '');\n    name = '-' + name;\n  } else {\n    name = '';\n  }\n  name = 'screencapture' + name + '-' + Date.now() + '.png';\n  var url = 'filesystem:chrome-extension://' + chrome.i18n.getMessage('@@extension_id') + '/temporary/' + name;\n\n  window.webkitRequestFileSystem(window.TEMPORARY, size, function (fs) {\n    fs.root.getFile(name, {create: true}, function (fileEntry) {\n      fileEntry.createWriter(function (fileWriter) {\n        fileWriter.onwriteend = () => callBack(url);\n        fileWriter.write(blob);\n      });\n    });\n  });\n}\n\n\nfunction screenshotCaptured(screenshot, pageUrl, pageTitle){\n  console.log(screenshot);\n  storeFromDataCanvas(screenshot.canvas, pageUrl, function(fileUrl){\n\n    var capturedImage = {\n      link: fileUrl,\n      size: {width: screenshot.canvas.width, height: screenshot.canvas.height},\n      url: pageUrl,\n      pins: sendedrequest.pins,\n      pageTitle: sendedrequest.pageTitle || pageTitle\n    };\n\n      var capturedImages = JSON.parse(localStorage.capturedImages || '[]');\n      var images = JSON.parse(localStorage.images || '[]');\n      images.push(capturedImage);\n      capturedImages.push(capturedImage);\n      localStorage.capturedImages = JSON.stringify(capturedImages);\n      localStorage.images = JSON.stringify(images);\n      chrome.runtime.sendMessage({msg: 'captured', capturedImage: capturedImage});\n      screenshot.canvas = null;\n      sendedrequest = {};\n      cropData = null;\n\n\n  });\n}\n\n\n\nfunction sendRequestPin(request, sender, callback){\n  var pin = request.pin;\n  var token = localStorage.token;\n  var post = request.boardData.posts[0];\n  var parentPin = request.parentPin;\n\n  console.log(request);\n\n  if (request.msg == 'addPin'){\n\n    var method = pin.updated ? 'PUT' : 'POST';\n    var urlPart = method == 'POST' ? 'posts/' + post.id + '/tasks/' : 'tasks/'+ pin.id;\n\n    httprequest('http://api.codesign.io/' + urlPart, pin.updated ? 'PUT' :'POST', {\n      \"Authorization\": 'Token ' + token,\n      \"Content-Type\": \"application/json;charset=UTF-8\"\n    }, {\n      marker: {\n        geometry: {\n          left: pin.x/request.width * 100,\n          top: pin.y/request.height * 100,\n          relativeX: pin.relativeX,\n          relativeY: pin.relativeY,\n          cssPath: pin.cssPath,\n        },\n        measure: 'pixel',\n        shape: \"PN\"\n      },\n      title: pin.text\n    }, function (data) {\n      callback(data)\n    })\n  } else if (request.msg == 'addComment'){\n\n    var method = pin.updated ? 'PUT' : 'POST';\n    var urlPart = method == 'POST' ? 'tasks/' + request.parentPin.id + '/comments/' : 'comments/'+ pin.id;\n\n      httprequest('http://api.codesign.io/'+ urlPart, method , {\n      \"Authorization\": 'Token ' + token,\n      \"Content-Type\": \"application/json;charset=UTF-8\"\n    }, {\n      title: pin.text\n    }, function (data) {\n        callback(data)\n      })\n\n  } else if (request.msg == 'deletePin'){\n\n    httprequest('http://api.codesign.io/tasks/' + pin.id, 'DELETE', {\n      \"Authorization\": 'Token ' + token,\n      \"Content-Type\": \"application/json;charset=UTF-8\"\n    }, {}, function (data) {})\n\n  } else if (request.msg == 'deleteComment'){\n\n    httprequest('http://api.codesign.io/comments/' + pin.id, 'DELETE', {\n      \"Authorization\": 'Token ' + token,\n      \"Content-Type\": \"application/json;charset=UTF-8\"\n    }, {}, function (data) {})\n\n\n  } else if (request.msg == 'completePin'){\n\n    httprequest('http://api.codesign.io/tasks/'+ pin.id, 'PUT', {\n      \"Authorization\": 'Token ' + token,\n      \"Content-Type\": \"application/json;charset=UTF-8\"\n    }, {\n      status: pin.completed ? \"CP\" : \"AC\"\n    }, function (data) {})\n  }\n}\n\n\nfunction loadBoardData(req, sender, sendResponse){\n  var token = localStorage.token\n  var code = req.boardCode;\n  httprequest('http://api.codesign.io/get_board/?code='+code, 'GET', {\"Authorization\": 'Token ' +  token}, null, function (data) {\n\n    var url = data.board.title;\n    sendResponse({url: url});\n\n    var pins = data.board.posts[0].tasks;\n\n    setTimeout(function(){\n      chrome.tabs.getSelected(null, function (tab) {\n        chrome.tabs.executeScript(tab.id, {code: 'window.codesign = {me: '+ localStorage.me+'};'+ 'window.codesignPins = ' + JSON.stringify(pins) + ';'+ 'window.codesignBoardData = ' + JSON.stringify(data.board)}, function () {\n          chrome.tabs.executeScript(tab.id, {file: 'page-script-compiled/comment.js'}, function () {\n            chrome.tabs.sendRequest(tab.id, {msg: 'loadPins'}, function () {\n            });\n          });\n        });\n      })\n    }, 1000)\n\n  })\n}\n\n\n\nfunction shareImage (req, sender, sendResponse){\n  var token = localStorage.token;\n  var capturedImages = JSON.parse(localStorage.capturedImages);\n  var sharedImage = capturedImages.filter((img)=> img.link == req.image.link)[0];\n\n  httprequest('http://api.codesign.io/folders/', 'GET', {\"Authorization\": 'Token ' +  token}, null, function (data) {\n\n    var folders = data.results;\n    var sharedFolder = data.results.filter((fol) => fol.title == \"My live boards\")[0];\n\n    if (!sharedFolder){\n      httprequest('http://api.codesign.io/folders/', 'POST', {\"Authorization\": 'Token ' +  token, \"Content-Type\": \"application/json;charset=UTF-8\"}, {\n\n        title: \"My live boards\"\n\n      }, function (data) {\n        createSharedPage(data)\n      })\n    } else {\n      createSharedPage(sharedFolder)\n    }\n\n\n    function createSharedPage(sharedFolder){\n      httprequest('http://api.codesign.io/folders/'+ sharedFolder.id + '/boards/', 'POST', {\"Authorization\": 'Token ' + token, \"Content-Type\": \"application/json;charset=UTF-8\" }, {\n        title: sharedImage.url\n      }, function (boardData) {\n\n        httprequest('http://api.codesign.io/boards/'+ boardData.id + '/posts/', 'POST', {\n          \"Authorization\": 'Token ' + token,\n          \"Content-Type\": \"application/json;charset=UTF-8\"\n        }, {\n          title: (new Date).toString()\n        }, function (postData) {\n\n\n          var reqCount = 0;\n          for (var i = 0; i < sharedImage.pins.length;i++) {\n            var pin = sharedImage.pins[i];\n            httprequest('http://api.codesign.io/posts/' + postData.id + '/tasks/', 'POST', {\n              \"Authorization\": 'Token ' + token,\n              \"Content-Type\": \"application/json;charset=UTF-8\"\n            }, {\n              marker: {\n                geometry: {\n                  left: pin.x/sharedImage.size.width * 100,\n                  top: pin.y/sharedImage.size.height * 100,\n                  relativeX: pin.relativeX,\n                  relativeY: pin.relativeY,\n                  cssPath: pin.cssPath,\n                },\n                measure: 'pixel',\n                shape: \"PN\"\n              },\n              title: pin.text\n            }, function (data3) {\n\n\n\n              function CompleteRequest(){\n                reqCount++;\n                if (reqCount == sharedImage.pins.length) {\n\n                  var url = 'http://www.codesign.io/board/'+boardData.client_code+'?liveBoardPage'\n                  sharedImage.sharedLink = url;\n                  localStorage.capturedImages = JSON.stringify(capturedImages);\n                  chrome.runtime.sendMessage({msg: 'sharedImage', url: url})\n                }\n              }\n\n\n              function CheckComments(){\n                if(!pin.children.length){\n                  CompleteRequest();\n                } else {\n                  var commentsCount = 0;\n                  for (var i = 0; i < pin.children.length; i++) {\n                    var comment = pin.children[i];\n\n\n                    httprequest('http://api.codesign.io/tasks/' + data3.id + '/comments/', 'POST', {\n                      \"Authorization\": 'Token ' + token,\n                      \"Content-Type\": \"application/json;charset=UTF-8\"\n                    }, {\n                      title: comment.text\n                    }, function () {\n                      commentsCount++;\n                      if (commentsCount == pin.children.length){\n                        CompleteRequest();\n                      }\n\n                    })\n                  }\n                }\n              }\n\n              if (pin.completed){\n                httprequest('http://api.codesign.io/tasks/'+ data3.id, 'PUT', {\n                  \"Authorization\": 'Token ' + token,\n                  \"Content-Type\": \"application/json;charset=UTF-8\"\n                }, {\n                  status: \"CP\"\n                }, function () {\n                  CheckComments()\n                })\n\n              } else {\n                CheckComments();\n              }\n\n            });\n          }\n\n\n\n        })\n\n      });\n    }\n\n  })\n\n\n}\n\n\n\n\n\nfunction uploadImages(req, sender, sendResponse){\n  var token = localStorage.token;\n  var activeBoard = req.activeBoard;\n  var activeFolder = req.activeFolder;\n  var posts = [];\n  var capturedImages = JSON.parse(localStorage.capturedImages);\n\n  function logCallBack(value){\n    chrome.runtime.sendMessage({msg: 'progress', progress: value, progressMsg: 'Uploading...'})\n  }\n\n\n  if(activeBoard.id == 'new_board'){\n    httprequest('http://api.codesign.io/folders/'+ activeFolder.id + '/boards/', 'POST', {\"Authorization\": 'Token ' + token, \"Content-Type\": \"application/json;charset=UTF-8\" }, {\n      title: capturedImages[0].pageTitle\n    }, function (data) {\n      activeBoard = data;\n      uploadImageProcess(activeBoard,posts, logCallBack);\n    });\n\n  } else {\n\n    httprequest('http://api.codesign.io/boards/' + activeBoard.id + '/posts/', 'GET', {\"Authorization\": 'Token ' + token}, null, function (data) {\n      posts = data.results;\n      uploadImageProcess(activeBoard,posts, logCallBack);\n    });\n  }\n}\n\nfunction uploadImageProcess(activeBoard,posts, logCallBack){\n\n  var token = localStorage.token;\n  var capturedImages = JSON.parse(localStorage.capturedImages);\n\n  var capImgCount=0;\n  capturedImages.forEach(function(capturedImage){\n\n    httprequest('http://api.codesign.io/boards/'+ activeBoard.id + '/posts/', 'POST', {\n      \"Authorization\": 'Token ' + token,\n      \"Content-Type\": \"application/json;charset=UTF-8\"\n    }, {\n      title: capturedImage.url + \" \" + (new Date).toString()\n    }, function (data) {\n      console.log(data);\n      httprequest('http://api.codesign.io/posts/'+ data.id + '/images/get_upload_url/?filename='+ capturedImage.name +'&image_type=image%2Fjpeg&thumbnail_type=image%2Fjpeg', 'GET', {\"Authorization\": 'Token ' + token}, null, function (data1) {\n        console.log(data1);\n\n        window.webkitResolveLocalFileSystemURL(capturedImage.link, function(fileEntry){\n          console.log('fillllle');\n          fileEntry.file(function(file) {\n            s3Upload(data1.image_upload_url, file, logCallBack, function (data2) {\n\n              var canvas = document.createElement('canvas');\n              canvas.width = 250;\n              canvas.height = 150;\n              var image = new Image();\n              image.onload = function () {\n                canvas.getContext('2d').drawImage(image, 0,0, this.width, this.height, 0,0, 250,150);\n\n                var blob =  dataURItoBlob(canvas.toDataURL());\n                s3Upload(data1.thumbnail_upload_url, blob, logCallBack, function () {\n\n                  httprequest('http://api.codesign.io/posts/'+ data.id +'/images/', 'POST', {\n                    \"Authorization\": 'Token ' + token,\n                    \"Content-Type\": \"application/json;charset=UTF-8\"\n                  }, {\n                    image_upload_url:data1.image_upload_url,\n                    thumbnail_upload_url: data1.thumbnail_upload_url,\n                    width: capturedImage.size.width,\n                    height: capturedImage.size.height\n                  }, function (data3) {\n\n                    httprequest('http://api.codesign.io/boards/'+ activeBoard.id + '/update_order/', 'POST', {\"Authorization\": 'Token ' + token, \"Content-Type\": \"application/json;charset=UTF-8\"}, {\n                      keys: posts.map((post)=> post.id).concat(data.id)\n                    }, function () {\n\n\n                      if(capturedImage.pins){\n\n                        var reqCount = 0;\n                        for (var i = 0; i < capturedImage.pins.length;i++) {\n                          var pin = capturedImage.pins[i];\n                          httprequest('http://api.codesign.io/posts/' + data.id + '/tasks/', 'POST', {\n                            \"Authorization\": 'Token ' + token,\n                            \"Content-Type\": \"application/json;charset=UTF-8\"\n                          }, {\n                            marker: {\n                              geometry: {\n                                left: pin.x/capturedImage.size.width * 100,\n                                top: pin.y/capturedImage.size.height * 100,\n                                relativeX: pin.relativeX,\n                                relativeY: pin.relativeY,\n                                cssPath: pin.cssPath,\n                              },\n                              measure: 'pixel',\n                              shape: \"PN\"\n                            },\n                            title: pin.text\n                          }, function (data3) {\n\n\n\n                            function CompleteRequest(){\n                              reqCount++;\n                              if (reqCount == capturedImage.pins.length) {\n\n                                capImgCount++;\n\n                                if (capImgCount == capturedImages.length) {\n                                  window.open(\"http://www.codesign.io/board/\" + activeBoard.client_code);\n                                  chrome.browserAction.setBadgeText({text: ''});\n                                  localStorage.capturedImages = '[]';\n                                }\n\n                              }\n                            }\n\n\n                            function CheckComments(){\n                              if(!pin.children.length){\n                                CompleteRequest();\n                              } else {\n                                var commentsCount = 0;\n                                for (var i = 0; i < pin.children.length; i++) {\n                                  var comment = pin.children[i];\n\n\n                                  httprequest('http://api.codesign.io/tasks/' + data3.id + '/comments/', 'POST', {\n                                    \"Authorization\": 'Token ' + token,\n                                    \"Content-Type\": \"application/json;charset=UTF-8\"\n                                  }, {\n                                    title: comment.text\n                                  }, function () {\n                                    commentsCount++;\n                                    if (commentsCount == pin.children.length){\n                                      CompleteRequest();\n                                    }\n\n                                  })\n                                }\n                              }\n                            }\n\n                            if (pin.completed){\n                              httprequest('http://api.codesign.io/tasks/'+ data3.id, 'PUT', {\n                                \"Authorization\": 'Token ' + token,\n                                \"Content-Type\": \"application/json;charset=UTF-8\"\n                              }, {\n                                status: \"CP\"\n                              }, function () {\n\n                                CheckComments()\n\n                              })\n\n                            } else {\n                              CheckComments();\n                            }\n\n\n\n\n                          });\n                        }\n\n\n                      } else {\n\n                        capImgCount++;\n\n                        if(capImgCount == capturedImages.length){\n                          window.open(\"http://www.codesign.io/board/\" + activeBoard.client_code);\n                          chrome.browserAction.setBadgeText({text: ''});\n                          localStorage.capturedImages = '[]';\n                        }\n\n                      }\n\n\n                    });\n\n                  });\n\n                });\n\n              };\n              image.src = capturedImage.link;\n\n            });\n          });\n        });\n\n\n      });\n\n    });\n  })\n\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./background.js\n **/","export function request(url, method, headers, body, callback){\n  var xhr = new XMLHttpRequest();\n  var json = JSON.stringify(body);\n  xhr.open(method, url, true);\n  for (var i in headers){\n    xhr.setRequestHeader(i, headers[i]);\n  };\n  xhr.onreadystatechange = function() {\n    if (xhr.readyState != 4) return;\n    callback(JSON.parse(xhr.responseText || '{}'));\n  };\n  xhr.send(json);\n}\n\nexport function s3Upload(url, imageFile, logCallback, callBack){\n\n  var xhr = new XMLHttpRequest();\n  xhr.onerror = e => {\n    console.log('error')\n  };\n\n  xhr.upload.addEventListener('progress', e => {\n    var percent = Math.round((e.loaded / e.total) * 100);\n    logCallback(percent);\n  }, false);\n\n  xhr.onreadystatechange = () => {\n    if (xhr.readyState === XMLHttpRequest.DONE) {\n      if (xhr.status >= 200 && xhr.status <= 299) {\n        callBack(xhr.responseText)\n      } else {\n        console.log('error')\n      }\n    }\n  };\n\n  xhr.open('PUT', url, true);\n  xhr.setRequestHeader('Content-Type', 'image/jpeg');\n  xhr.setRequestHeader('Cache-Control', 'public, max-age=31536000');\n  xhr.send(imageFile);\n}\n\nexport function dataURItoBlob(dataURL) {\n  var BASE64_MARKER = ';base64,';\n  if (dataURL.indexOf(BASE64_MARKER) == -1) {\n    var parts = dataURL.split(',');\n    var contentType = parts[0].split(':')[1];\n    var raw = decodeURIComponent(parts[1]);\n\n    return new Blob([raw], {type: contentType});\n  }\n\n  var parts = dataURL.split(BASE64_MARKER);\n  var contentType = parts[0].split(':')[1];\n  var raw = window.atob(parts[1]);\n  var rawLength = raw.length;\n\n  var uInt8Array = new Uint8Array(rawLength);\n\n  for (var i = 0; i < rawLength; ++i) {\n    uInt8Array[i] = raw.charCodeAt(i);\n  }\n\n  return new Blob([uInt8Array], {type: contentType});\n}\n\n\n/** WEBPACK FOOTER **\n ** ./app/utils.js\n **/"],"sourceRoot":""}